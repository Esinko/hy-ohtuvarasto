{% extends "base.html" %}

{% block title %}{{ warehouse.name }} - Warehouse Manager{% endblock %}

{% block content %}
<div class="hero">
    <h2>{{ warehouse.name }}</h2>
    <div class="hero-meta">
        <span>Capacity: {{ warehouse.tilavuus }}</span>
        <span>Used: {{ warehouse.saldo }}</span>
        <span>Space left: {{ "%.1f"|format(warehouse.get_space_left_percent()) }}%</span>
        <span>Items: {{ warehouse.get_item_count() }}</span>
    </div>
</div>

<h3>Items</h3>

{% if warehouse.items %}
    {% if edit_mode %}
    <form action="{{ url_for('update_items', warehouse_id=warehouse_id) }}" method="post" class="edit-items-form">
        <ul class="item-list">
            {% for item_name, quantity in warehouse.items.items() %}
                <li class="item-row editing">
                    <div class="item-info">
                        <span class="item-name">{{ item_name }}</span>
                        <span class="item-current-qty">(current: {{ quantity }})</span>
                    </div>
                    <div class="item-actions">
                        <input type="number" name="qty_{{ item_name }}" class="edit-quantity" value="{{ quantity }}" step="0.1" min="0" max="{{ warehouse.tilavuus }}">
                    </div>
                </li>
            {% endfor %}
        </ul>
        <div class="button-row">
            <button type="submit" class="btn">Save Changes</button>
            <a href="{{ url_for('warehouse_detail', warehouse_id=warehouse_id) }}" class="btn">Cancel</a>
        </div>
    </form>
    {% else %}
    <ul class="item-list">
        {% for item_name, quantity in warehouse.items.items() %}
            <li class="item-row">
                <div class="item-info">
                    <span class="item-name">{{ item_name }}</span>
                    <span class="item-quantity">({{ quantity }})</span>
                </div>
            </li>
        {% endfor %}
    </ul>
    <div class="edit-mode-toggle">
        <a href="{{ url_for('warehouse_detail', warehouse_id=warehouse_id, edit='1') }}" class="btn">Edit Items</a>
    </div>
    {% endif %}
{% else %}
    <div class="empty-state">
        <p>No items in this warehouse.</p>
        <p><a href="{{ url_for('add_item') }}" class="btn">Add an item</a></p>
    </div>
{% endif %}

<div class="actions">
    <a href="{{ url_for('add_item') }}" class="btn">Add Item</a>
    <a href="{{ url_for('edit_warehouse', warehouse_id=warehouse_id) }}" class="btn">Edit Warehouse</a>
    <form action="{{ url_for('delete_warehouse', warehouse_id=warehouse_id) }}" method="post" class="inline-form" style="flex:1;display:flex;">
        <button type="submit" class="btn btn-danger" style="flex:1;" onclick="return confirm('Are you sure you want to delete this warehouse?')">Delete Warehouse</button>
    </form>
</div>
{% endblock %}
